var nr=Object.defineProperty;var rr=(e,t,n)=>t in e?nr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var $=(e,t,n)=>rr(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const l=(e,t,n)=>{const r=(n||document).querySelector(t);if(r===null)throw new Error(`Element ${t} does not exist.`);if(r.tagName!==e.toUpperCase())throw new Error(`Element ${t} is not a ${e}, but a ${r.tagName.toLowerCase()}.`);return r},an=e=>e.content.cloneNode(!0),or={scene:l("div",".scene")},Ne=new Map,O=e=>{var t;for(const n of or.scene.children)n.classList.toggle("hidden",n.id!==e);(t=Ne.get(e))==null||t.forEach(n=>n())},at=(e,t)=>{let n=Ne.get(e);n||(n=new Set,Ne.set(e,n)),n.add(t)},cn=(e,t)=>{at(e,()=>{var n;t(),(n=Ne.get(e))==null||n.delete(t)})};let un="";const sr=()=>un,_e=e=>{un=e,O("user-display")};function p(e,t,n){function r(a,u){var c;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(c=a._zod).traits??(c.traits=new Set),a._zod.traits.add(e),t(a,u);for(const d in i.prototype)d in a||Object.defineProperty(a,d,{value:i.prototype[d].bind(a)});a._zod.constr=i,a._zod.def=u}const o=(n==null?void 0:n.Parent)??Object;class s extends o{}Object.defineProperty(s,"name",{value:e});function i(a){var u;const c=n!=null&&n.Parent?new s:this;r(c,a),(u=c._zod).deferred??(u.deferred=[]);for(const d of c._zod.deferred)d();return c}return Object.defineProperty(i,"init",{value:r}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>{var u,c;return n!=null&&n.Parent&&a instanceof n.Parent?!0:(c=(u=a==null?void 0:a._zod)==null?void 0:u.traits)==null?void 0:c.has(e)}}),Object.defineProperty(i,"name",{value:e}),i}class xe extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const ln={};function te(e){return ln}function ir(e){const t=Object.values(e).filter(r=>typeof r=="number");return Object.entries(e).filter(([r,o])=>t.indexOf(+r)===-1).map(([r,o])=>o)}function ar(e,t){return typeof t=="bigint"?t.toString():t}function dn(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function ct(e){return e==null}function ut(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function cr(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,o=n>r?n:r,s=Number.parseInt(e.toFixed(o).replace(".","")),i=Number.parseInt(t.toFixed(o).replace(".",""));return s%i/10**o}function I(e,t,n){Object.defineProperty(e,t,{get(){{const r=n();return e[t]=r,r}},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function lt(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function pn(e=10){const t="abcdefghijklmnopqrstuvwxyz";let n="";for(let r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n}function fe(e){return JSON.stringify(e)}const hn=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function Qe(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const ur=dn(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function et(e){if(Qe(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(Qe(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}const lr=new Set(["string","number","symbol"]);function ze(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ae(e,t,n){const r=new e._zod.constr(t??e._zod.def);return(!t||n!=null&&n.parent)&&(r._zod.parent=e),r}function g(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function dr(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const pr={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function hr(e,t){const n={},r=e._zod.def;for(const o in t){if(!(o in r.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(n[o]=r.shape[o])}return ae(e,{...e._zod.def,shape:n,checks:[]})}function fr(e,t){const n={...e._zod.def.shape},r=e._zod.def;for(const o in t){if(!(o in r.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&delete n[o]}return ae(e,{...e._zod.def,shape:n,checks:[]})}function mr(e,t){const n={...e._zod.def,get shape(){const r={...e._zod.def.shape,...t};return lt(this,"shape",r),r},checks:[]};return ae(e,n)}function gr(e,t){return ae(e,{...e._zod.def,get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return lt(this,"shape",n),n},catchall:t._zod.def.catchall,checks:[]})}function br(e,t,n){const r=t._zod.def.shape,o={...r};if(n)for(const s in n){if(!(s in r))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(o[s]=e?new e({type:"optional",innerType:r[s]}):r[s])}else for(const s in r)o[s]=e?new e({type:"optional",innerType:r[s]}):r[s];return ae(t,{...t._zod.def,shape:o,checks:[]})}function kr(e,t,n){const r=t._zod.def.shape,o={...r};if(n)for(const s in n){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(o[s]=new e({type:"nonoptional",innerType:r[s]}))}else for(const s in r)o[s]=new e({type:"nonoptional",innerType:r[s]});return ae(t,{...t._zod.def,shape:o,checks:[]})}function ke(e,t=0){for(let n=t;n<e.issues.length;n++)if(e.issues[n].continue!==!0)return!0;return!1}function oe(e,t){return t.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(e),n})}function Ee(e){return typeof e=="string"?e:e==null?void 0:e.message}function ne(e,t,n){var o,s,i,a,u,c;const r={...e,path:e.path??[]};if(!e.message){const d=Ee((i=(s=(o=e.inst)==null?void 0:o._zod.def)==null?void 0:s.error)==null?void 0:i.call(s,e))??Ee((a=t==null?void 0:t.error)==null?void 0:a.call(t,e))??Ee((u=n.customError)==null?void 0:u.call(n,e))??Ee((c=n.localeError)==null?void 0:c.call(n,e))??"Invalid input";r.message=d}return delete r.inst,delete r.continue,t!=null&&t.reportInput||delete r.input,r}function dt(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function ye(...e){const[t,n,r]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:r}:{...t}}const fn=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(t,ar,2)},enumerable:!0})},mn=p("$ZodError",fn),gn=p("$ZodError",fn,{Parent:Error});function vr(e,t=n=>n.message){const n={},r=[];for(const o of e.issues)o.path.length>0?(n[o.path[0]]=n[o.path[0]]||[],n[o.path[0]].push(t(o))):r.push(t(o));return{formErrors:r,fieldErrors:n}}function wr(e,t){const n=t||function(s){return s.message},r={_errors:[]},o=s=>{for(const i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>o({issues:a}));else if(i.code==="invalid_key")o({issues:i.issues});else if(i.code==="invalid_element")o({issues:i.issues});else if(i.path.length===0)r._errors.push(n(i));else{let a=r,u=0;for(;u<i.path.length;){const c=i.path[u];u===i.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(n(i))):a[c]=a[c]||{_errors:[]},a=a[c],u++}}};return o(e),r}const _r=e=>(t,n,r,o)=>{const s=r?Object.assign(r,{async:!1}):{async:!1},i=t._zod.run({value:n,issues:[]},s);if(i instanceof Promise)throw new xe;if(i.issues.length){const a=new((o==null?void 0:o.Err)??e)(i.issues.map(u=>ne(u,s,te())));throw hn(a,o==null?void 0:o.callee),a}return i.value},xr=e=>async(t,n,r,o)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let i=t._zod.run({value:n,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){const a=new((o==null?void 0:o.Err)??e)(i.issues.map(u=>ne(u,s,te())));throw hn(a,o==null?void 0:o.callee),a}return i.value},bn=e=>(t,n,r)=>{const o=r?{...r,async:!1}:{async:!1},s=t._zod.run({value:n,issues:[]},o);if(s instanceof Promise)throw new xe;return s.issues.length?{success:!1,error:new(e??mn)(s.issues.map(i=>ne(i,o,te())))}:{success:!0,data:s.value}},yr=bn(gn),kn=e=>async(t,n,r)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let s=t._zod.run({value:n,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(i=>ne(i,o,te())))}:{success:!0,data:s.value}},$r=kn(gn),zr=/^[cC][^\s-]{8,}$/,Sr=/^[0-9a-z]+$/,Zr=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Er=/^[0-9a-vA-V]{20}$/,Lr=/^[A-Za-z0-9]{27}$/,Tr=/^[a-zA-Z0-9_-]{21}$/,Ir=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Rr=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Tt=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,Pr=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Cr="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Ar(){return new RegExp(Cr,"u")}const Nr=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Dr=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Or=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Br=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jr=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,vn=/^[A-Za-z0-9_-]*$/,Ur=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,Mr=/^\+(?:[0-9]){6,14}[0-9]$/,wn="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Fr=new RegExp(`^${wn}$`);function _n(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function qr(e){return new RegExp(`^${_n(e)}$`)}function Wr(e){const t=_n({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-]\\d{2}:\\d{2})");const r=`${t}(?:${n.join("|")})`;return new RegExp(`^${wn}T(?:${r})$`)}const Gr=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},Hr=/^\d+$/,Vr=/^-?\d+(?:\.\d+)?/i,Kr=/true|false/i,Jr=/^[^A-Z]*$/,Yr=/^[^a-z]*$/,M=p("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),xn={number:"number",bigint:"bigint",object:"date"},yn=p("$ZodCheckLessThan",(e,t)=>{M.init(e,t);const n=xn[typeof t.value];e._zod.onattach.push(r=>{const o=r._zod.bag,s=(t.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<s&&(t.inclusive?o.maximum=t.value:o.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),$n=p("$ZodCheckGreaterThan",(e,t)=>{M.init(e,t);const n=xn[typeof t.value];e._zod.onattach.push(r=>{const o=r._zod.bag,s=(t.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>s&&(t.inclusive?o.minimum=t.value:o.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Xr=p("$ZodCheckMultipleOf",(e,t)=>{M.init(e,t),e._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):cr(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),Qr=p("$ZodCheckNumberFormat",(e,t)=>{var i;M.init(e,t),t.format=t.format||"float64";const n=(i=t.format)==null?void 0:i.includes("int"),r=n?"int":"number",[o,s]=pr[t.format];e._zod.onattach.push(a=>{const u=a._zod.bag;u.format=t.format,u.minimum=o,u.maximum=s,n&&(u.pattern=Hr)}),e._zod.check=a=>{const u=a.value;if(n){if(!Number.isInteger(u)){a.issues.push({expected:r,format:t.format,code:"invalid_type",input:u,inst:e});return}if(!Number.isSafeInteger(u)){u>0?a.issues.push({input:u,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,continue:!t.abort}):a.issues.push({input:u,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,continue:!t.abort});return}}u<o&&a.issues.push({origin:"number",input:u,code:"too_small",minimum:o,inclusive:!0,inst:e,continue:!t.abort}),u>s&&a.issues.push({origin:"number",input:u,code:"too_big",maximum:s,inst:e})}}),eo=p("$ZodCheckMaxLength",(e,t)=>{M.init(e,t),e._zod.when=n=>{const r=n.value;return!ct(r)&&r.length!==void 0},e._zod.onattach.push(n=>{const r=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<r&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const r=n.value;if(r.length<=t.maximum)return;const s=dt(r);n.issues.push({origin:s,code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),to=p("$ZodCheckMinLength",(e,t)=>{M.init(e,t),e._zod.when=n=>{const r=n.value;return!ct(r)&&r.length!==void 0},e._zod.onattach.push(n=>{const r=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>r&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const r=n.value;if(r.length>=t.minimum)return;const s=dt(r);n.issues.push({origin:s,code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),no=p("$ZodCheckLengthEquals",(e,t)=>{M.init(e,t),e._zod.when=n=>{const r=n.value;return!ct(r)&&r.length!==void 0},e._zod.onattach.push(n=>{const r=n._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=n=>{const r=n.value,o=r.length;if(o===t.length)return;const s=dt(r),i=o>t.length;n.issues.push({origin:s,...i?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},input:n.value,inst:e,continue:!t.abort})}}),Fe=p("$ZodCheckStringFormat",(e,t)=>{var n;M.init(e,t),e._zod.onattach.push(r=>{const o=r._zod.bag;o.format=t.format,t.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(t.pattern))}),(n=e._zod).check??(n.check=r=>{if(!t.pattern)throw new Error("Not implemented.");t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})})}),ro=p("$ZodCheckRegex",(e,t)=>{Fe.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),oo=p("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=Jr),Fe.init(e,t)}),so=p("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=Yr),Fe.init(e,t)}),io=p("$ZodCheckIncludes",(e,t)=>{M.init(e,t);const n=ze(t.includes),r=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=r,e._zod.onattach.push(o=>{const s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),e._zod.check=o=>{o.value.includes(t.includes,t.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:o.value,inst:e,continue:!t.abort})}}),ao=p("$ZodCheckStartsWith",(e,t)=>{M.init(e,t);const n=new RegExp(`^${ze(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),co=p("$ZodCheckEndsWith",(e,t)=>{M.init(e,t);const n=new RegExp(`.*${ze(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}}),uo=p("$ZodCheckOverwrite",(e,t)=>{M.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class lo{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const r=t.split(`
`).filter(i=>i),o=Math.min(...r.map(i=>i.length-i.trimStart().length)),s=r.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(const i of s)this.content.push(i)}compile(){const t=Function,n=this==null?void 0:this.args,o=[...((this==null?void 0:this.content)??[""]).map(s=>`  ${s}`)];return new t(...n,o.join(`
`))}}const po={major:4,minor:0,patch:0},Z=p("$ZodType",(e,t)=>{var o;var n;e??(e={}),I(e._zod,"id",()=>t.type+"_"+pn(10)),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=po;const r=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&r.unshift(e);for(const s of r)for(const i of s._zod.onattach)i(e);if(r.length===0)(n=e._zod).deferred??(n.deferred=[]),(o=e._zod.deferred)==null||o.push(()=>{e._zod.run=e._zod.parse});else{const s=(i,a,u)=>{let c=ke(i),d;for(const m of a){if(m._zod.when){if(!m._zod.when(i))continue}else if(c)continue;const h=i.issues.length,b=m._zod.check(i);if(b instanceof Promise&&(u==null?void 0:u.async)===!1)throw new xe;if(d||b instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await b,i.issues.length!==h&&(c||(c=ke(i,h)))});else{if(i.issues.length===h)continue;c||(c=ke(i,h))}}return d?d.then(()=>i):i};e._zod.run=(i,a)=>{const u=e._zod.parse(i,a);if(u instanceof Promise){if(a.async===!1)throw new xe;return u.then(c=>s(c,r,a))}return s(u,r,a)}}e["~standard"]={validate:s=>{var i;try{const a=yr(e,s);return a.success?{value:a.data}:{issues:(i=a.error)==null?void 0:i.issues}}catch{return $r(e,s).then(u=>{var c;return u.success?{value:u.data}:{issues:(c=u.error)==null?void 0:c.issues}})}},vendor:"zod",version:1}}),pt=p("$ZodString",(e,t)=>{var n;Z.init(e,t),e._zod.pattern=[...((n=e==null?void 0:e._zod.bag)==null?void 0:n.patterns)??[]].pop()??Gr(e._zod.bag),e._zod.parse=(r,o)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),E=p("$ZodStringFormat",(e,t)=>{Fe.init(e,t),pt.init(e,t)}),ho=p("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Rr),E.init(e,t)}),fo=p("$ZodUUID",(e,t)=>{if(t.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(r===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Tt(r))}else t.pattern??(t.pattern=Tt());E.init(e,t)}),mo=p("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Pr),E.init(e,t)}),go=p("$ZodURL",(e,t)=>{E.init(e,t),e._zod.check=n=>{try{const r=new URL(n.value);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Ur.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort}));return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),bo=p("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=Ar()),E.init(e,t)}),ko=p("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Tr),E.init(e,t)}),vo=p("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=zr),E.init(e,t)}),wo=p("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Sr),E.init(e,t)}),_o=p("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Zr),E.init(e,t)}),xo=p("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Er),E.init(e,t)}),yo=p("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Lr),E.init(e,t)}),$o=p("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Wr(t)),E.init(e,t),e._zod.check}),zo=p("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Fr),E.init(e,t)}),So=p("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=qr(t)),E.init(e,t),e._zod.check}),Zo=p("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Ir),E.init(e,t)}),Eo=p("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Nr),E.init(e,t),e._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv4"})}),Lo=p("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Dr),E.init(e,t),e._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv6"}),e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),To=p("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=Or),E.init(e,t)}),Io=p("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Br),E.init(e,t),e._zod.check=n=>{const[r,o]=n.value.split("/");try{if(!o)throw new Error;const s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function zn(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Ro=p("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=jr),E.init(e,t),e._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),e._zod.check=n=>{zn(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function Po(e){if(!vn.test(e))return!1;const t=e.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return zn(n)}const Co=p("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=vn),E.init(e,t),e._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),e._zod.check=n=>{Po(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),Ao=p("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Mr),E.init(e,t)});function No(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[r]=n,o=JSON.parse(atob(r));return!("typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||t&&(!("alg"in o)||o.alg!==t))}catch{return!1}}const Do=p("$ZodJWT",(e,t)=>{E.init(e,t),e._zod.check=n=>{No(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),Sn=p("$ZodNumber",(e,t)=>{Z.init(e,t),e._zod.pattern=e._zod.bag.pattern??Vr,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const o=n.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return n;const s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:o,inst:e,...s?{received:s}:{}}),n}}),Oo=p("$ZodNumber",(e,t)=>{Qr.init(e,t),Sn.init(e,t)}),Bo=p("$ZodBoolean",(e,t)=>{Z.init(e,t),e._zod.pattern=Kr,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=!!n.value}catch{}const o=n.value;return typeof o=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:e}),n}}),jo=p("$ZodUnknown",(e,t)=>{Z.init(e,t),e._zod.parse=n=>n}),Uo=p("$ZodNever",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function It(e,t,n){e.issues.length&&t.issues.push(...oe(n,e.issues)),t.value[n]=e.value}const Mo=p("$ZodArray",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>{const o=n.value;if(!Array.isArray(o))return n.issues.push({expected:"array",code:"invalid_type",input:o,inst:e}),n;n.value=Array(o.length);const s=[];for(let i=0;i<o.length;i++){const a=o[i],u=t.element._zod.run({value:a,issues:[]},r);u instanceof Promise?s.push(u.then(c=>It(c,n,i))):It(u,n,i)}return s.length?Promise.all(s).then(()=>n):n}});function Le(e,t,n){e.issues.length&&t.issues.push(...oe(n,e.issues)),t.value[n]=e.value}function Rt(e,t,n,r){e.issues.length?r[n]===void 0?n in r?t.value[n]=void 0:t.value[n]=e.value:t.issues.push(...oe(n,e.issues)):e.value===void 0?n in r&&(t.value[n]=void 0):t.value[n]=e.value}const Fo=p("$ZodObject",(e,t)=>{Z.init(e,t);const n=dn(()=>{const m=Object.keys(t.shape);for(const b of m)if(!(t.shape[b]instanceof Z))throw new Error(`Invalid element at key "${b}": expected a Zod schema`);const h=dr(t.shape);return{shape:t.shape,keys:m,keySet:new Set(m),numKeys:m.length,optionalKeys:new Set(h)}});I(e._zod,"propValues",()=>{const m=t.shape,h={};for(const b in m){const k=m[b]._zod;if(k.values){h[b]??(h[b]=new Set);for(const L of k.values)h[b].add(L)}}return h});const r=m=>{const h=new lo(["shape","payload","ctx"]),{keys:b,optionalKeys:k}=n.value,L=A=>{const S=fe(A);return`shape[${S}]._zod.run({ value: input[${S}], issues: [] }, ctx)`};h.write("const input = payload.value;");const J=Object.create(null);for(const A of b)J[A]=pn(15);h.write("const newResult = {}");for(const A of b)if(k.has(A)){const S=J[A];h.write(`const ${S} = ${L(A)};`);const P=fe(A);h.write(`
        if (${S}.issues.length) {
          if (input[${P}] === undefined) {
            if (${P} in input) {
              newResult[${P}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${S}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${P}, ...iss.path] : [${P}],
              }))
            );
          }
        } else if (${S}.value === undefined) {
          if (${P} in input) newResult[${P}] = undefined;
        } else {
          newResult[${P}] = ${S}.value;
        }
        `)}else{const S=J[A];h.write(`const ${S} = ${L(A)};`),h.write(`
          if (${S}.issues.length) payload.issues = payload.issues.concat(${S}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${fe(A)}, ...iss.path] : [${fe(A)}]
          })));`),h.write(`newResult[${fe(A)}] = ${S}.value`)}h.write("payload.value = newResult;"),h.write("return payload;");const Y=h.compile();return(A,S)=>Y(m,A,S)};let o;const s=Qe,i=!ln.jitless,u=i&&ur.value,{catchall:c}=t;let d;e._zod.parse=(m,h)=>{d??(d=n.value);const b=m.value;if(!s(b))return m.issues.push({expected:"object",code:"invalid_type",input:b,inst:e}),m;const k=[];if(i&&u&&(h==null?void 0:h.async)===!1&&h.jitless!==!0)o||(o=r(t.shape)),m=o(m,h);else{m.value={};const S=d.shape;for(const P of d.keys){const re=S[P],X=re._zod.run({value:b[P],issues:[]},h),Q=re._zod.optin==="optional"&&re._zod.optout==="optional";X instanceof Promise?k.push(X.then(Lt=>Q?Rt(Lt,m,P,b):Le(Lt,m,P))):Q?Rt(X,m,P,b):Le(X,m,P)}}if(!c)return k.length?Promise.all(k).then(()=>m):m;const L=[],J=d.keySet,Y=c._zod,A=Y.def.type;for(const S of Object.keys(b)){if(J.has(S))continue;if(A==="never"){L.push(S);continue}const P=Y.run({value:b[S],issues:[]},h);P instanceof Promise?k.push(P.then(re=>Le(re,m,S))):Le(P,m,S)}return L.length&&m.issues.push({code:"unrecognized_keys",keys:L,input:b,inst:e}),k.length?Promise.all(k).then(()=>m):m}});function Pt(e,t,n,r){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(o=>o.issues.map(s=>ne(s,r,te())))}),t}const qo=p("$ZodUnion",(e,t)=>{Z.init(e,t),I(e._zod,"values",()=>{if(t.options.every(n=>n._zod.values))return new Set(t.options.flatMap(n=>Array.from(n._zod.values)))}),I(e._zod,"pattern",()=>{if(t.options.every(n=>n._zod.pattern)){const n=t.options.map(r=>r._zod.pattern);return new RegExp(`^(${n.map(r=>ut(r.source)).join("|")})$`)}}),e._zod.parse=(n,r)=>{let o=!1;const s=[];for(const i of t.options){const a=i._zod.run({value:n.value,issues:[]},r);if(a instanceof Promise)s.push(a),o=!0;else{if(a.issues.length===0)return a;s.push(a)}}return o?Promise.all(s).then(i=>Pt(i,n,e,r)):Pt(s,n,e,r)}}),Wo=p("$ZodIntersection",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>{const{value:o}=n,s=t.left._zod.run({value:o,issues:[]},r),i=t.right._zod.run({value:o,issues:[]},r);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([u,c])=>Ct(n,u,c)):Ct(n,s,i)}});function tt(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(et(e)&&et(t)){const n=Object.keys(t),r=Object.keys(e).filter(s=>n.indexOf(s)!==-1),o={...e,...t};for(const s of r){const i=tt(e[s],t[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<e.length;r++){const o=e[r],s=t[r],i=tt(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[r,...i.mergeErrorPath]};n.push(i.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Ct(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),ke(e))return e;const r=tt(t.value,n.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return e.value=r.data,e}const Go=p("$ZodRecord",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>{const o=n.value;if(!et(o))return n.issues.push({expected:"record",code:"invalid_type",input:o,inst:e}),n;const s=[];if(t.keyType._zod.values){const i=t.keyType._zod.values;n.value={};for(const u of i)if(typeof u=="string"||typeof u=="number"||typeof u=="symbol"){const c=t.valueType._zod.run({value:o[u],issues:[]},r);c instanceof Promise?s.push(c.then(d=>{d.issues.length&&n.issues.push(...oe(u,d.issues)),n.value[u]=d.value})):(c.issues.length&&n.issues.push(...oe(u,c.issues)),n.value[u]=c.value)}let a;for(const u in o)i.has(u)||(a=a??[],a.push(u));a&&a.length>0&&n.issues.push({code:"unrecognized_keys",input:o,inst:e,keys:a})}else{n.value={};for(const i of Reflect.ownKeys(o)){if(i==="__proto__")continue;const a=t.keyType._zod.run({value:i,issues:[]},r);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){n.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(c=>ne(c,r,te())),input:i,path:[i],inst:e}),n.value[a.value]=a.value;continue}const u=t.valueType._zod.run({value:o[i],issues:[]},r);u instanceof Promise?s.push(u.then(c=>{c.issues.length&&n.issues.push(...oe(i,c.issues)),n.value[a.value]=c.value})):(u.issues.length&&n.issues.push(...oe(i,u.issues)),n.value[a.value]=u.value)}}return s.length?Promise.all(s).then(()=>n):n}}),Ho=p("$ZodEnum",(e,t)=>{Z.init(e,t);const n=ir(t.entries);e._zod.values=new Set(n),e._zod.pattern=new RegExp(`^(${n.filter(r=>lr.has(typeof r)).map(r=>typeof r=="string"?ze(r):r.toString()).join("|")})$`),e._zod.parse=(r,o)=>{const s=r.value;return e._zod.values.has(s)||r.issues.push({code:"invalid_value",values:n,input:s,inst:e}),r}}),Vo=p("$ZodLiteral",(e,t)=>{Z.init(e,t),e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(n=>typeof n=="string"?ze(n):n?n.toString():String(n)).join("|")})$`),e._zod.parse=(n,r)=>{const o=n.value;return e._zod.values.has(o)||n.issues.push({code:"invalid_value",values:t.values,input:o,inst:e}),n}}),Ko=p("$ZodTransform",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>{const o=t.transform(n.value,n);if(r.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(n.value=i,n));if(o instanceof Promise)throw new xe;return n.value=o,n}}),Jo=p("$ZodOptional",(e,t)=>{Z.init(e,t),e._zod.optin="optional",e._zod.optout="optional",I(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),I(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${ut(n.source)})?$`):void 0}),e._zod.parse=(n,r)=>n.value===void 0?n:t.innerType._zod.run(n,r)}),Yo=p("$ZodNullable",(e,t)=>{Z.init(e,t),I(e._zod,"optin",()=>t.innerType._zod.optin),I(e._zod,"optout",()=>t.innerType._zod.optout),I(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${ut(n.source)}|null)$`):void 0}),I(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,r)=>n.value===null?n:t.innerType._zod.run(n,r)}),Xo=p("$ZodDefault",(e,t)=>{Z.init(e,t),e._zod.optin="optional",I(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(n.value===void 0)return n.value=t.defaultValue,n;const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(s=>At(s,t)):At(o,t)}});function At(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Qo=p("$ZodPrefault",(e,t)=>{Z.init(e,t),e._zod.optin="optional",I(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>(n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,r))}),es=p("$ZodNonOptional",(e,t)=>{Z.init(e,t),I(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),e._zod.parse=(n,r)=>{const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(s=>Nt(s,e)):Nt(o,e)}});function Nt(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const ts=p("$ZodCatch",(e,t)=>{Z.init(e,t),I(e._zod,"optin",()=>t.innerType._zod.optin),I(e._zod,"optout",()=>t.innerType._zod.optout),I(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(s=>(n.value=s.value,s.issues.length&&(n.value=t.catchValue({...n,error:{issues:s.issues.map(i=>ne(i,r,te()))},input:n.value}),n.issues=[]),n)):(n.value=o.value,o.issues.length&&(n.value=t.catchValue({...n,error:{issues:o.issues.map(s=>ne(s,r,te()))},input:n.value}),n.issues=[]),n)}}),ns=p("$ZodPipe",(e,t)=>{Z.init(e,t),I(e._zod,"values",()=>t.in._zod.values),I(e._zod,"optin",()=>t.in._zod.optin),I(e._zod,"optout",()=>t.out._zod.optout),e._zod.parse=(n,r)=>{const o=t.in._zod.run(n,r);return o instanceof Promise?o.then(s=>Dt(s,t,r)):Dt(o,t,r)}});function Dt(e,t,n){return ke(e)?e:t.out._zod.run({value:e.value,issues:e.issues},n)}const rs=p("$ZodReadonly",(e,t)=>{Z.init(e,t),I(e._zod,"propValues",()=>t.innerType._zod.propValues),I(e._zod,"optin",()=>t.innerType._zod.optin),I(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(n,r)=>{const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(Ot):Ot(o)}});function Ot(e){return e.value=Object.freeze(e.value),e}const os=p("$ZodCustom",(e,t)=>{M.init(e,t),Z.init(e,t),e._zod.parse=(n,r)=>n,e._zod.check=n=>{const r=n.value,o=t.fn(r);if(o instanceof Promise)return o.then(s=>Bt(s,n,r,e));Bt(o,n,r,e)}});function Bt(e,t,n,r){if(!e){const o={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(o.params=r._zod.def.params),t.issues.push(ye(o))}}class ss{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const r=n[0];if(this._map.set(t,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,t)}return this}remove(t){return this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const r={...this.get(n)??{}};return delete r.id,{...r,...this._map.get(t)}}return this._map.get(t)}has(t){return this._map.has(t)}}function is(){return new ss}const Te=is();function as(e,t){return new e({type:"string",...g(t)})}function cs(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...g(t)})}function jt(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...g(t)})}function us(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...g(t)})}function ls(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...g(t)})}function ds(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...g(t)})}function ps(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...g(t)})}function hs(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...g(t)})}function fs(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...g(t)})}function ms(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...g(t)})}function gs(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...g(t)})}function bs(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...g(t)})}function ks(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...g(t)})}function vs(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...g(t)})}function ws(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...g(t)})}function _s(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...g(t)})}function xs(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...g(t)})}function ys(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...g(t)})}function $s(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...g(t)})}function zs(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...g(t)})}function Ss(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...g(t)})}function Zs(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...g(t)})}function Es(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...g(t)})}function Ls(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...g(t)})}function Ts(e,t){return new e({type:"string",format:"date",check:"string_format",...g(t)})}function Is(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...g(t)})}function Rs(e,t){return new e({type:"string",format:"duration",check:"string_format",...g(t)})}function Ps(e,t){return new e({type:"number",checks:[],...g(t)})}function Cs(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...g(t)})}function As(e,t){return new e({type:"boolean",...g(t)})}function Ns(e){return new e({type:"unknown"})}function Ds(e,t){return new e({type:"never",...g(t)})}function Ut(e,t){return new yn({check:"less_than",...g(t),value:e,inclusive:!1})}function Ke(e,t){return new yn({check:"less_than",...g(t),value:e,inclusive:!0})}function Mt(e,t){return new $n({check:"greater_than",...g(t),value:e,inclusive:!1})}function Je(e,t){return new $n({check:"greater_than",...g(t),value:e,inclusive:!0})}function Ft(e,t){return new Xr({check:"multiple_of",...g(t),value:e})}function Zn(e,t){return new eo({check:"max_length",...g(t),maximum:e})}function De(e,t){return new to({check:"min_length",...g(t),minimum:e})}function En(e,t){return new no({check:"length_equals",...g(t),length:e})}function Os(e,t){return new ro({check:"string_format",format:"regex",...g(t),pattern:e})}function Bs(e){return new oo({check:"string_format",format:"lowercase",...g(e)})}function js(e){return new so({check:"string_format",format:"uppercase",...g(e)})}function Us(e,t){return new io({check:"string_format",format:"includes",...g(t),includes:e})}function Ms(e,t){return new ao({check:"string_format",format:"starts_with",...g(t),prefix:e})}function Fs(e,t){return new co({check:"string_format",format:"ends_with",...g(t),suffix:e})}function Se(e){return new uo({check:"overwrite",tx:e})}function qs(e){return Se(t=>t.normalize(e))}function Ws(){return Se(e=>e.trim())}function Gs(){return Se(e=>e.toLowerCase())}function Hs(){return Se(e=>e.toUpperCase())}function Vs(e,t,n){return new e({type:"array",element:t,...g(n)})}function Ks(e,t,n){return new e({type:"custom",check:"custom",fn:t,...g(n)})}const Js=p("ZodISODateTime",(e,t)=>{$o.init(e,t),R.init(e,t)});function Ys(e){return Ls(Js,e)}const Xs=p("ZodISODate",(e,t)=>{zo.init(e,t),R.init(e,t)});function Qs(e){return Ts(Xs,e)}const ei=p("ZodISOTime",(e,t)=>{So.init(e,t),R.init(e,t)});function ti(e){return Is(ei,e)}const ni=p("ZodISODuration",(e,t)=>{Zo.init(e,t),R.init(e,t)});function ri(e){return Rs(ni,e)}const oi=(e,t)=>{mn.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>wr(e,n)},flatten:{value:n=>vr(e,n)},addIssue:{value:n=>e.issues.push(n)},addIssues:{value:n=>e.issues.push(...n)},isEmpty:{get(){return e.issues.length===0}}})},qe=p("ZodError",oi,{Parent:Error}),si=_r(qe),ii=xr(qe),ai=bn(qe),ci=kn(qe),C=p("ZodType",(e,t)=>(Z.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone({...t,checks:[...t.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),e.clone=(n,r)=>ae(e,n,r),e.brand=()=>e,e.register=(n,r)=>(n.add(e,r),e),e.parse=(n,r)=>si(e,n,r,{callee:e.parse}),e.safeParse=(n,r)=>ai(e,n,r),e.parseAsync=async(n,r)=>ii(e,n,r,{callee:e.parseAsync}),e.safeParseAsync=async(n,r)=>ci(e,n,r),e.spa=e.safeParseAsync,e.refine=(n,r)=>e.check(ra(n,r)),e.superRefine=n=>e.check(oa(n)),e.overwrite=n=>e.check(Se(n)),e.optional=()=>Ht(e),e.nullable=()=>Vt(e),e.nullish=()=>Ht(Vt(e)),e.nonoptional=n=>Ki(e,n),e.array=()=>Pi(e),e.or=n=>Ni([e,n]),e.and=n=>Oi(e,n),e.transform=n=>Kt(e,Fi(n)),e.default=n=>Gi(e,n),e.prefault=n=>Vi(e,n),e.catch=n=>Yi(e,n),e.pipe=n=>Kt(e,n),e.readonly=()=>ea(e),e.describe=n=>{const r=e.clone();return Te.add(r,{description:n}),r},Object.defineProperty(e,"description",{get(){var n;return(n=Te.get(e))==null?void 0:n.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return Te.get(e);const r=e.clone();return Te.add(r,n[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Ln=p("_ZodString",(e,t)=>{pt.init(e,t),C.init(e,t);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...r)=>e.check(Os(...r)),e.includes=(...r)=>e.check(Us(...r)),e.startsWith=(...r)=>e.check(Ms(...r)),e.endsWith=(...r)=>e.check(Fs(...r)),e.min=(...r)=>e.check(De(...r)),e.max=(...r)=>e.check(Zn(...r)),e.length=(...r)=>e.check(En(...r)),e.nonempty=(...r)=>e.check(De(1,...r)),e.lowercase=r=>e.check(Bs(r)),e.uppercase=r=>e.check(js(r)),e.trim=()=>e.check(Ws()),e.normalize=(...r)=>e.check(qs(...r)),e.toLowerCase=()=>e.check(Gs()),e.toUpperCase=()=>e.check(Hs())}),ui=p("ZodString",(e,t)=>{pt.init(e,t),Ln.init(e,t),e.email=n=>e.check(cs(li,n)),e.url=n=>e.check(hs(di,n)),e.jwt=n=>e.check(Es(Si,n)),e.emoji=n=>e.check(fs(pi,n)),e.guid=n=>e.check(jt(qt,n)),e.uuid=n=>e.check(us(Ie,n)),e.uuidv4=n=>e.check(ls(Ie,n)),e.uuidv6=n=>e.check(ds(Ie,n)),e.uuidv7=n=>e.check(ps(Ie,n)),e.nanoid=n=>e.check(ms(hi,n)),e.guid=n=>e.check(jt(qt,n)),e.cuid=n=>e.check(gs(fi,n)),e.cuid2=n=>e.check(bs(mi,n)),e.ulid=n=>e.check(ks(gi,n)),e.base64=n=>e.check(zs(yi,n)),e.base64url=n=>e.check(Ss($i,n)),e.xid=n=>e.check(vs(bi,n)),e.ksuid=n=>e.check(ws(ki,n)),e.ipv4=n=>e.check(_s(vi,n)),e.ipv6=n=>e.check(xs(wi,n)),e.cidrv4=n=>e.check(ys(_i,n)),e.cidrv6=n=>e.check($s(xi,n)),e.e164=n=>e.check(Zs(zi,n)),e.datetime=n=>e.check(Ys(n)),e.date=n=>e.check(Qs(n)),e.time=n=>e.check(ti(n)),e.duration=n=>e.check(ri(n))});function v(e){return as(ui,e)}const R=p("ZodStringFormat",(e,t)=>{E.init(e,t),Ln.init(e,t)}),li=p("ZodEmail",(e,t)=>{mo.init(e,t),R.init(e,t)}),qt=p("ZodGUID",(e,t)=>{ho.init(e,t),R.init(e,t)}),Ie=p("ZodUUID",(e,t)=>{fo.init(e,t),R.init(e,t)}),di=p("ZodURL",(e,t)=>{go.init(e,t),R.init(e,t)}),pi=p("ZodEmoji",(e,t)=>{bo.init(e,t),R.init(e,t)}),hi=p("ZodNanoID",(e,t)=>{ko.init(e,t),R.init(e,t)}),fi=p("ZodCUID",(e,t)=>{vo.init(e,t),R.init(e,t)}),mi=p("ZodCUID2",(e,t)=>{wo.init(e,t),R.init(e,t)}),gi=p("ZodULID",(e,t)=>{_o.init(e,t),R.init(e,t)}),bi=p("ZodXID",(e,t)=>{xo.init(e,t),R.init(e,t)}),ki=p("ZodKSUID",(e,t)=>{yo.init(e,t),R.init(e,t)}),vi=p("ZodIPv4",(e,t)=>{Eo.init(e,t),R.init(e,t)}),wi=p("ZodIPv6",(e,t)=>{Lo.init(e,t),R.init(e,t)}),_i=p("ZodCIDRv4",(e,t)=>{To.init(e,t),R.init(e,t)}),xi=p("ZodCIDRv6",(e,t)=>{Io.init(e,t),R.init(e,t)}),yi=p("ZodBase64",(e,t)=>{Ro.init(e,t),R.init(e,t)}),$i=p("ZodBase64URL",(e,t)=>{Co.init(e,t),R.init(e,t)}),zi=p("ZodE164",(e,t)=>{Ao.init(e,t),R.init(e,t)}),Si=p("ZodJWT",(e,t)=>{Do.init(e,t),R.init(e,t)}),Tn=p("ZodNumber",(e,t)=>{Sn.init(e,t),C.init(e,t),e.gt=(r,o)=>e.check(Mt(r,o)),e.gte=(r,o)=>e.check(Je(r,o)),e.min=(r,o)=>e.check(Je(r,o)),e.lt=(r,o)=>e.check(Ut(r,o)),e.lte=(r,o)=>e.check(Ke(r,o)),e.max=(r,o)=>e.check(Ke(r,o)),e.int=r=>e.check(Wt(r)),e.safe=r=>e.check(Wt(r)),e.positive=r=>e.check(Mt(0,r)),e.nonnegative=r=>e.check(Je(0,r)),e.negative=r=>e.check(Ut(0,r)),e.nonpositive=r=>e.check(Ke(0,r)),e.multipleOf=(r,o)=>e.check(Ft(r,o)),e.step=(r,o)=>e.check(Ft(r,o)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function pe(e){return Ps(Tn,e)}const Zi=p("ZodNumberFormat",(e,t)=>{Oo.init(e,t),Tn.init(e,t)});function Wt(e){return Cs(Zi,e)}const Ei=p("ZodBoolean",(e,t)=>{Bo.init(e,t),C.init(e,t)});function ht(e){return As(Ei,e)}const Li=p("ZodUnknown",(e,t)=>{jo.init(e,t),C.init(e,t)});function Gt(){return Ns(Li)}const Ti=p("ZodNever",(e,t)=>{Uo.init(e,t),C.init(e,t)});function Ii(e){return Ds(Ti,e)}const Ri=p("ZodArray",(e,t)=>{Mo.init(e,t),C.init(e,t),e.element=t.element,e.min=(n,r)=>e.check(De(n,r)),e.nonempty=n=>e.check(De(1,n)),e.max=(n,r)=>e.check(Zn(n,r)),e.length=(n,r)=>e.check(En(n,r)),e.unwrap=()=>e.element});function Pi(e,t){return Vs(Ri,e,t)}const Ci=p("ZodObject",(e,t)=>{Fo.init(e,t),C.init(e,t),I(e,"shape",()=>Object.fromEntries(Object.entries(e._zod.def.shape))),e.keyof=()=>In(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Gt()}),e.loose=()=>e.clone({...e._zod.def,catchall:Gt()}),e.strict=()=>e.clone({...e._zod.def,catchall:Ii()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>mr(e,n),e.merge=n=>gr(e,n),e.pick=n=>hr(e,n),e.omit=n=>fr(e,n),e.partial=(...n)=>br(Rn,e,n[0]),e.required=(...n)=>kr(Pn,e,n[0])});function w(e,t){const n={type:"object",get shape(){return lt(this,"shape",{...e}),this.shape},...g(t)};return new Ci(n)}const Ai=p("ZodUnion",(e,t)=>{qo.init(e,t),C.init(e,t),e.options=t.options});function Ni(e,t){return new Ai({type:"union",options:e,...g(t)})}const Di=p("ZodIntersection",(e,t)=>{Wo.init(e,t),C.init(e,t)});function Oi(e,t){return new Di({type:"intersection",left:e,right:t})}const Bi=p("ZodRecord",(e,t)=>{Go.init(e,t),C.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function ji(e,t,n){return new Bi({type:"record",keyType:e,valueType:t,...g(n)})}const nt=p("ZodEnum",(e,t)=>{Ho.init(e,t),C.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(r,o)=>{const s={};for(const i of r)if(n.has(i))s[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new nt({...t,checks:[],...g(o),entries:s})},e.exclude=(r,o)=>{const s={...t.entries};for(const i of r)if(n.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new nt({...t,checks:[],...g(o),entries:s})}});function In(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(r=>[r,r])):e;return new nt({type:"enum",entries:n,...g(t)})}const Ui=p("ZodLiteral",(e,t)=>{Vo.init(e,t),C.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function W(e,t){return new Ui({type:"literal",values:Array.isArray(e)?e:[e],...g(t)})}const Mi=p("ZodTransform",(e,t)=>{Ko.init(e,t),C.init(e,t),e._zod.parse=(n,r)=>{n.addIssue=s=>{if(typeof s=="string")n.issues.push(ye(s,n.value,t));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=n.value),i.inst??(i.inst=e),i.continue??(i.continue=!0),n.issues.push(ye(i))}};const o=t.transform(n.value,n);return o instanceof Promise?o.then(s=>(n.value=s,n)):(n.value=o,n)}});function Fi(e){return new Mi({type:"transform",transform:e})}const Rn=p("ZodOptional",(e,t)=>{Jo.init(e,t),C.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ht(e){return new Rn({type:"optional",innerType:e})}const qi=p("ZodNullable",(e,t)=>{Yo.init(e,t),C.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Vt(e){return new qi({type:"nullable",innerType:e})}const Wi=p("ZodDefault",(e,t)=>{Xo.init(e,t),C.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Gi(e,t){return new Wi({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const Hi=p("ZodPrefault",(e,t)=>{Qo.init(e,t),C.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Vi(e,t){return new Hi({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const Pn=p("ZodNonOptional",(e,t)=>{es.init(e,t),C.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ki(e,t){return new Pn({type:"nonoptional",innerType:e,...g(t)})}const Ji=p("ZodCatch",(e,t)=>{ts.init(e,t),C.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Yi(e,t){return new Ji({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Xi=p("ZodPipe",(e,t)=>{ns.init(e,t),C.init(e,t),e.in=t.in,e.out=t.out});function Kt(e,t){return new Xi({type:"pipe",in:e,out:t})}const Qi=p("ZodReadonly",(e,t)=>{rs.init(e,t),C.init(e,t)});function ea(e){return new Qi({type:"readonly",innerType:e})}const ta=p("ZodCustom",(e,t)=>{os.init(e,t),C.init(e,t)});function na(e,t){const n=new M({check:"custom",...g(t)});return n._zod.check=e,n}function ra(e,t={}){return Ks(ta,e,t)}function oa(e,t){const n=na(r=>(r.addIssue=o=>{if(typeof o=="string")r.issues.push(ye(o,r.value,n._zod.def));else{const s=o;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=n),s.continue??(s.continue=!n._zod.def.abort),r.issues.push(ye(s))}},e(r.value,r)),t);return n}const ce=w({_id:v(),username:v(),display_name:v(),created:pe().transform(e=>new Date(e*1e3)),avatar:v(),bot:ht(),banned_until:pe(),permissions:v().array(),profile:w({bio:v(),lastfm:v(),css:v().optional()}),banner:v().optional()}),Cn=w({_id:v(),created:pe().transform(e=>new Date(e*1e3)),content:v(),get replies(){return Cn.array()},attachments:v().array(),author:ce.omit({profile:!0}).or(v())}),An=w({_id:v(),created:pe().transform(e=>new Date(e*1e3)),content:v(),replies:Cn.array(),attachments:v().array(),author:ce.omit({profile:!0})}),Nn=ji(v(),w({client:v().nullable()})),sa=w({_id:v(),created:pe().transform(e=>new Date(e*1e3)),content:v(),author:v()}),ia=":root{--deer-background: #ffffff;--deer-foreground: #000000;--deer-reply: #303030;--deer-button: #ebebeb;--deer-button-hover: #e0e0e0;--deer-button-disabled: #9b9b9b;--deer-error: #000000;--deer-seperator: #aaaaaa;--deer-horizontalrule: #9e9a8f;--deer-image-border: #a19e95;--deer-container-background: #d3d3d3;--deer-danger-background: #ffdbdb}",aa=":root{--deer-background: #fff8e7;--deer-foreground: #292825;--deer-reply: #46443f;--deer-button: #cec8b8;--deer-button-hover: #ebe4d5;--deer-button-disabled: #8f897c;--deer-error: #201f1b;--deer-seperator: #b9b5a8;--deer-horizontalrule: #9e9a8f;--deer-image-border: #a19e95;--deer-container-background: #e2dbcc;--deer-danger-background: #d4b1b1}",ca=":root{--deer-background: #2e2d2b;--deer-foreground: #ede4d5;--deer-reply: #c2baac;--deer-button: #4d4a45;--deer-button-hover: #403d39;--deer-button-disabled: #282623;--deer-error: #f2b149;--deer-seperator: #474643;--deer-horizontalrule: #6e6b65;--deer-image-border: #383531;--deer-container-background: #34322f;--deer-danger-background: #422b2b}",ua=":root{--deer-background: #303030;--deer-foreground: #e6f0f6;--deer-reply: #c8c8c8;--deer-button: #4c4c4c;--deer-button-hover: #434343;--deer-button-disabled: #242424;--deer-error: #5394d2;--deer-seperator: #4a4a4a;--deer-horizontalrule: #747474;--deer-image-border: #3e3e3e;--deer-container-background: #383838;--deer-danger-background: #422b2b}",la=":root{--deer-background: #000000;--deer-foreground: #ffffff;--deer-reply: #d6d6d6;--deer-button: #1a1a1a;--deer-button-hover: #1f1f1f;--deer-button-disabled: #3d3d3d;--deer-error: #ffffff;--deer-seperator: #383838;--deer-horizontalrule: #464646;--deer-image-border: #383838;--deer-container-background: #292929;--deer-danger-background: #382727}",da='@import"https://fonts.googleapis.com/css2?family=Asap:ital,wght@0,100..900;1,100..900&display=swap";:root{--deer-background: #020617;--deer-foreground: #cbd5e1;--deer-reply: #cbd5e1;--deer-button: #1e293b;--deer-button-hover: #1e293b;--deer-button-disabled: #1e293b;--deer-error: #1e293b;--deer-seperator: #cbd5e1;--deer-horizontalrule: #cbd5e1;--deer-image-border: #0000000;--deer-container-background: #020617;--deer-danger-background: #020617}#error-bar,.mc-preview-error{color:var(--deer-foreground)}body{width:min(100%,100ch);margin:0 auto}body,button,input,textarea{font-family:Asap,"Noto Color Emoji",sitelen seli kiwen}body:before{text-align:center;font-weight:700;display:block;content:"BearDeer";font-size:1.875rem}code,button,input,textarea,.post,.album-cover,#ud-lastfm-container,#ud-bio-container,.mc-container,#ms-danger-container,.mc-theme-preview,.mc-preview-post,.mc-preview-pfp,.mm-container{border-radius:.75rem}input,textarea{background-color:transparent;border:2px solid var(--deer-button)}a,#nav button,#ms-userbox button,#ms-ulist>span{color:#38bdf8;text-decoration:underline;padding:0;background:0;font-size:1rem}#ms-ulist>span>.client-icon{display:none}#nav,#ms-userbox{display:flex;align-items:center;justify-content:center;gap:.5rem;margin-top:0}#ms-hide-guest-nav{display:contents}#nav .ms-seperator,#ms-userbox.hidden{display:none}.scene{margin-top:0}#ms-make-post>center{display:flex;text-align:center;gap:.5ch}.ms-replies-wrapper{flex-direction:column;gap:0}.ms-replies-wrapper br{display:none}#ms-replies:empty{display:none}#ms-replies .reply:last-child{margin:0}#ms-msg-wrapper{flex-grow:1}#ms-msg{width:100%}.reply.clickable{opacity:40%;margin-bottom:.5rem}.post{padding:.25rem .5rem}.post>br{display:none}hr{display:none}.post>span.clickable[onclick^=showUser],.post>small{display:block;margin-bottom:.25rem}[id^=p-][id*=-attachment],[id^=p-][id*=-attachment]+br{display:none}',pa=":root{--deer-background: #303030;--deer-foreground: #e6f0f6;--deer-reply: #c8c8c8;--deer-button: #4c4c4c;--deer-button-hover: #434343;--deer-button-disabled: #242424;--deer-error: #5394d2;--deer-seperator: #4a4a4a;--deer-horizontalrule: #747474;--deer-image-border: #3e3e3e;--deer-container-background: #383838;--deer-danger-background: #422b2b}code{background-color:#1c1d20;display:block;border-radius:2px;box-shadow:inset 0 0 2px #00000096,0 0 2px #0000005e;border-bottom:1px solid #ffffff3d}button{border-radius:0;padding:7px;font-family:Noto Sans,sans-serif;border:1px solid var(--deer-horizontalrule);-webkit-box-shadow:#000 0 1px 0,0 1px 3px black;box-shadow:#000 0 1px,0 1px 3px #000;border-top:1px solid #fff3;transition:background .3s ease-in-out}input{border:none;border-radius:0;padding:7px;font-family:Noto Sans,sans-serif;font-size:13.3333px;border:1px solid var(--deer-horizontalrule);-webkit-box-shadow:#000 0 1px 0,0 1px 3px black;box-shadow:#000 0 1px,0 1px 3px #000}textarea:focus{outline:none;-webkit-box-shadow:#000 0 1px 0,0 1px 3px black,0 0 4px;box-shadow:#000 0 1px,0 1px 3px #000,0 2px 5px}textarea{min-width:180px;padding:8px;font-family:Noto Sans,sans-serif;margin-bottom:4px;vertical-align:middle;font-size:13.3333px;background-color:var(--deer-button-hover);color:var(--deer-foreground);border:1px solid var(--deer-horizontalrule);-webkit-box-shadow:#000 0 1px 0,0 1px 3px black;-moz-box-shadow:#000 0 1px 0,0 1px 3px black;box-shadow:#000 0 1px,0 1px 3px #000;transition:box-shadow .3s ease-in-out;overflow:hidden}hr{display:block;height:1px;border:0;border-top:1px solid;padding:0}blockquote{margin-left:70px;border-left:3px solid var(--deer-container-background);padding:12px;background-color:var(--deer-button);box-shadow:0 0 5px #00000021}#main{padding:10px}.post{padding:5px 7px 12px;margin-bottom:0;border-radius:0;box-shadow:0 0 4px -1px #000,inset 0 57px 10px -14px #ffffff08;border-bottom:1px dashed black;border-top:1px solid #ffffff24}.pfp{border-radius:1px;padding:1px;background:#fff}.mono{font-family:monospace}#ms-ulist{font-weight:700;color:var(--deer-reply);text-shadow:1px 1px black}#ms-msg{width:60vw;box-sizing:border-box}#ms-button-post{box-sizing:border-box}.album-cover{border-radius:2px}#ud-banner{height:78px;background:var(--deer-button-hover);margin-top:11px}#ud-lastfm-container{border-radius:2px}#ud-display-name{font-weight:700}#ud-bio-container{border-radius:2px;flex-grow:.5;display:flex;flex-direction:column}.title{background:var(--deer-button);padding:5px}#ud-bio-container #ud-bio,#ud-lastfm-container #ud-lastfm-wrapper{padding:5px}.mc-container,#mc-danger-container,.mc-theme-preview,.mc-preview-post{border-radius:2px}.mc-container{border-radius:2px;box-shadow:0 0 1px,0 0 14px -4px #000;flex:1}#error-bar{box-shadow:0 0 3px #000,inset 0 -2px 5px -2px #000}",Oe={theme:l("style","#theme"),customCSS:l("style","#custom-css")},We={Deer:ca,Helium:ua,Midnight:la,Bright:ia,"Cosmic Latte":aa,"Roarer 1":da,Souple:pa},Dn=Object.keys(We),ha=w({enterSends:ht(),theme:In(Dn),customCSS:v()}),fa={enterSends:!0,theme:"Deer",customCSS:""};let Be={};try{const e=localStorage.getItem("beardeer:settings");e&&(Be=ha.partial().parse(JSON.parse(e)))}catch{}const ee=e=>Be[e]??fa[e],ft=(e,t)=>{Be[e]=t,localStorage.setItem("beardeer:settings",JSON.stringify(Be)),e==="theme"&&(Oe.theme.innerHTML=We[t]),e==="customCSS"&&(Oe.customCSS.innerHTML=t)};Oe.theme.innerHTML=We[ee("theme")];Oe.customCSS.innerHTML=ee("customCSS");const ma=w({command:W("greet"),version:v(),messages:An.array(),ulist:Nn}),de=new WebSocket("wss://chaos.goog-search.eu.org/"),mt=new Promise(e=>{const t=n=>{const r=ma.safeParse(JSON.parse(n.data));r.success&&(e(r.data),de.removeEventListener("message",t))};de.addEventListener("message",t)});let On;const gt=new Promise(e=>{On=e}),Bn=(e,t)=>{localStorage.setItem("beardeer:token",e),On(t)};let ga=0;const D=(e,t)=>new Promise(n=>{const r=ga++,o=t.and(w({error:W(!1),listener:W(r)})).or(w({error:W(!0),code:v(),form:v(),context:v(),listener:W(r),banned_until:pe().transform(i=>new Date(i*1e3)).optional(),ban_reason:v().optional()})),s=async i=>{var u;const a=o.safeParse(JSON.parse(i.data));a.success&&(a.data.error?(console.log("!",a.data.code,a.data.code==="banned"),a.data.code==="banned"&&(alert(`You are banned until ${((u=a.data.banned_until)==null?void 0:u.toLocaleString())||"an unknown time"} for ${a.data.ban_reason||"an unknown reason"}. You will now be logged out.`),localStorage.removeItem("beardeer:token"),location.reload()),alert(`uh oh! ${a.data.context} (${a.data.code} in ${a.data.form})`),n(null)):n(a.data),de.removeEventListener("message",s))};mt.then(()=>{de.send(JSON.stringify({...e,listener:r})),de.addEventListener("message",s)})}),Ge=(e,t)=>{de.addEventListener("message",n=>{const r=e.safeParse(JSON.parse(n.data));r.success&&t(r.data)})},N=l("div","#main-config"),_={buttonBack:l("button","#mc-button-back",N),displayName:l("input","#mc-display-name",N),buttonDisplayName:l("button","#mc-button-display-name",N),avatar:l("input","#mc-avatar",N),buttonAvatar:l("button","#mc-button-avatar",N),banner:l("input","#mc-banner",N),buttonBanner:l("button","#mc-button-banner",N),css:l("textarea","#mc-css",N),buttonCSS:l("button","#mc-button-css",N),bio:l("textarea","#mc-bio",N),buttonBio:l("button","#mc-button-bio",N),lastfm:l("input","#mc-lastfm",N),buttonLastfm:l("button","#mc-button-lastfm",N),enterSends:l("input","#mc-enter-sends",N),selectedTheme:l("span","#mc-selected-theme",N),themes:l("div","#mc-themes",N),customCSS:l("textarea","#mc-custom-css",N),deleteAccountPassword:l("input","#mc-delete-account-password",N),buttonDeleteAccount:l("button","#mc-delete-account",N)};_.buttonBack.addEventListener("click",()=>{O("main-scene")});at("main-config",async()=>{_.enterSends.checked=ee("enterSends"),_.selectedTheme.textContent=ee("theme"),_.customCSS.textContent=ee("customCSS");const e=(await gt).username,t=await D({command:"get_user",username:e},w({user:ce}));if(!t){O("main-scene");return}_.displayName.value=t.user.display_name,_.avatar.value=t.user.avatar,_.banner.value=t.user.banner||"",_.css.value=t.user.profile.css||"",_.bio.value=t.user.profile.bio,_.lastfm.value=t.user.profile.lastfm});const he=(e,t)=>D({command:"set_property",property:e,value:t.value},w({}));_.buttonDisplayName.addEventListener("click",()=>he("display_name",_.displayName));_.buttonAvatar.addEventListener("click",()=>he("avatar",_.avatar));_.buttonBanner.addEventListener("click",()=>he("banner",_.banner));_.buttonCSS.addEventListener("click",()=>he("css",_.css));_.buttonBio.addEventListener("click",()=>he("bio",_.bio));_.buttonLastfm.addEventListener("click",()=>he("lastfm",_.lastfm));_.enterSends.addEventListener("input",()=>{ft("enterSends",_.enterSends.checked)});Dn.forEach(e=>{const t=document.createElement("button");t.textContent=e,t.addEventListener("click",()=>{ft("theme",e),_.selectedTheme.textContent=e}),_.themes.append(t)});_.customCSS.addEventListener("input",()=>{ft("customCSS",_.customCSS.value)});_.buttonDeleteAccount.addEventListener("click",async()=>{await D({command:"delete_account",password:_.deleteAccountPassword.value},w({}))&&(localStorage.removeItem("beardeer:token"),location.reload())});const Jt=l("div","#main-inbox"),rt={buttonBack:l("button","#mi-button-back",Jt),posts:l("div","#mi-posts",Jt)};rt.buttonBack.addEventListener("click",()=>{O("main-scene")});cn("main-inbox",async()=>{const e=await D({command:"get_inbox"},w({inbox:sa.array()}));e&&e.inbox.forEach(t=>{rt.posts.append(t.content);const n=document.createElement("em");n.style.display="block",n.style.marginBottom="1rem",n.textContent=` - @${t.author} (${t.created.toLocaleString()})`,rt.posts.append(n)})});const B=l("div","#main-moderation"),T={buttonBack:l("button","#mm-button-back",B),banUsername:l("input","#mm-ban-username",B),banDate:l("input","#mm-ban-date",B),banReason:l("input","#mm-ban-reason",B),ban:l("button","#mm-ban",B),generateInviteCode:l("button","#mm-generate-invite-code",B),resetInviteCodes:l("button","#mm-reset-invite-codes",B),forcekickUsername:l("input","#mm-forcekick-username",B),forcekick:l("button","#mm-forcekick",B),inboxMessage:l("input","#mm-inbox-message",B),inbox:l("button","#mm-inbox",B),ipsUsername:l("input","#mm-ips-username",B),ips:l("button","#mm-ips",B),ipBanIP:l("input","#mm-ipban-ip",B),ipBan:l("button","#mm-ipban",B)};T.buttonBack.addEventListener("click",()=>{O("main-scene")});T.ban.addEventListener("click",async()=>{const e=T.banDate.value;e&&await D({command:"ban",username:T.banUsername.value,banned_until:new Date(e).getTime()/1e3,ban_reason:T.banReason.value},w({}))&&(T.banUsername.value="",T.banDate.value="",T.banReason.value="")});T.generateInviteCode.addEventListener("click",async()=>{const e=await D({command:"gen_invite"},w({invite_code:v()}));e&&alert("Your invite code is: "+e.invite_code)});T.resetInviteCodes.addEventListener("click",async()=>{await D({command:"reset_invites"},w({}))});T.forcekick.addEventListener("click",async()=>{await D({command:"force_kick",username:T.forcekickUsername.value},w({}))&&(T.forcekickUsername.value="")});T.inbox.addEventListener("click",async()=>{await D({command:"post_inbox",content:T.inboxMessage.value,replies:[],attachments:[]},w({}))&&(T.inboxMessage.value="")});T.ips.addEventListener("click",async()=>{const e=await D({command:"get_ips",username:T.ipsUsername.value},w({ips:v().array()}));e&&(alert(`${T.ipsUsername.value}'s recent IPs are:
`+e.ips.map(t=>`- ${t}`).join(`
`)),T.ipsUsername.value="")});T.ipBan.addEventListener("click",async()=>{await D({command:"banish_to_the_SHADOW_REALM",ip:T.ipBanIP.value},w({}))&&(T.ipBanIP.value="")});function bt(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ue=bt();function jn(e){ue=e}var ve={exec:()=>null};function x(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(o,s)=>{let i=typeof s=="string"?s:s.source;return i=i.replace(j.caret,"$1"),n=n.replace(o,i),r},getRegex:()=>new RegExp(n,t)};return r}var j={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},ba=/^(?:[ \t]*(?:\n|$))+/,ka=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,va=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ze=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,wa=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,kt=/(?:[*+-]|\d{1,9}[.)])/,Un=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Mn=x(Un).replace(/bull/g,kt).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),_a=x(Un).replace(/bull/g,kt).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),vt=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,xa=/^[^\n]+/,wt=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ya=x(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",wt).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),$a=x(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,kt).getRegex(),He="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_t=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,za=x("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",_t).replace("tag",He).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Fn=x(vt).replace("hr",Ze).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",He).getRegex(),Sa=x(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Fn).getRegex(),xt={blockquote:Sa,code:ka,def:ya,fences:va,heading:wa,hr:Ze,html:za,lheading:Mn,list:$a,newline:ba,paragraph:Fn,table:ve,text:xa},Yt=x("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ze).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",He).getRegex(),Za={...xt,lheading:_a,table:Yt,paragraph:x(vt).replace("hr",Ze).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Yt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",He).getRegex()},Ea={...xt,html:x(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_t).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ve,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:x(vt).replace("hr",Ze).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Mn).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},La=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Ta=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,qn=/^( {2,}|\\)\n(?!\s*$)/,Ia=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ve=/[\p{P}\p{S}]/u,yt=/[\s\p{P}\p{S}]/u,Wn=/[^\s\p{P}\p{S}]/u,Ra=x(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,yt).getRegex(),Gn=/(?!~)[\p{P}\p{S}]/u,Pa=/(?!~)[\s\p{P}\p{S}]/u,Ca=/(?:[^\s\p{P}\p{S}]|~)/u,Aa=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Hn=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Na=x(Hn,"u").replace(/punct/g,Ve).getRegex(),Da=x(Hn,"u").replace(/punct/g,Gn).getRegex(),Vn="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Oa=x(Vn,"gu").replace(/notPunctSpace/g,Wn).replace(/punctSpace/g,yt).replace(/punct/g,Ve).getRegex(),Ba=x(Vn,"gu").replace(/notPunctSpace/g,Ca).replace(/punctSpace/g,Pa).replace(/punct/g,Gn).getRegex(),ja=x("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Wn).replace(/punctSpace/g,yt).replace(/punct/g,Ve).getRegex(),Ua=x(/\\(punct)/,"gu").replace(/punct/g,Ve).getRegex(),Ma=x(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Fa=x(_t).replace("(?:-->|$)","-->").getRegex(),qa=x("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Fa).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),je=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Wa=x(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",je).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Kn=x(/^!?\[(label)\]\[(ref)\]/).replace("label",je).replace("ref",wt).getRegex(),Jn=x(/^!?\[(ref)\](?:\[\])?/).replace("ref",wt).getRegex(),Ga=x("reflink|nolink(?!\\()","g").replace("reflink",Kn).replace("nolink",Jn).getRegex(),$t={_backpedal:ve,anyPunctuation:Ua,autolink:Ma,blockSkip:Aa,br:qn,code:Ta,del:ve,emStrongLDelim:Na,emStrongRDelimAst:Oa,emStrongRDelimUnd:ja,escape:La,link:Wa,nolink:Jn,punctuation:Ra,reflink:Kn,reflinkSearch:Ga,tag:qa,text:Ia,url:ve},Ha={...$t,link:x(/^!?\[(label)\]\((.*?)\)/).replace("label",je).getRegex(),reflink:x(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",je).getRegex()},ot={...$t,emStrongRDelimAst:Ba,emStrongLDelim:Da,url:x(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Va={...ot,br:x(qn).replace("{2,}","*").getRegex(),text:x(ot.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Re={normal:xt,gfm:Za,pedantic:Ea},me={normal:$t,gfm:ot,breaks:Va,pedantic:Ha},Ka={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xt=e=>Ka[e];function q(e,t){if(t){if(j.escapeTest.test(e))return e.replace(j.escapeReplace,Xt)}else if(j.escapeTestNoEncode.test(e))return e.replace(j.escapeReplaceNoEncode,Xt);return e}function Qt(e){try{e=encodeURI(e).replace(j.percentDecode,"%")}catch{return null}return e}function en(e,t){var s;const n=e.replace(j.findPipe,(i,a,u)=>{let c=!1,d=a;for(;--d>=0&&u[d]==="\\";)c=!c;return c?"|":" |"}),r=n.split(j.splitPipe);let o=0;if(r[0].trim()||r.shift(),r.length>0&&!((s=r.at(-1))!=null&&s.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;o<r.length;o++)r[o]=r[o].trim().replace(j.slashPipe,"|");return r}function ge(e,t,n){const r=e.length;if(r===0)return"";let o=0;for(;o<r&&e.charAt(r-o-1)===t;)o++;return e.slice(0,r-o)}function Ja(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function tn(e,t,n,r,o){const s=t.href,i=t.title||null,a=e[1].replace(o.other.outputLinkReplace,"$1");r.state.inLink=!0;const u={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:i,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,u}function Ya(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const o=r[1];return t.split(`
`).map(s=>{const i=s.match(n.other.beginningSpace);if(i===null)return s;const[a]=i;return a.length>=o.length?s.slice(o.length):s}).join(`
`)}var Ue=class{constructor(e){$(this,"options");$(this,"rules");$(this,"lexer");this.options=e||ue}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:ge(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=Ya(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=ge(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:ge(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=ge(t[0],`
`).split(`
`),r="",o="";const s=[];for(;n.length>0;){let i=!1;const a=[];let u;for(u=0;u<n.length;u++)if(this.rules.other.blockquoteStart.test(n[u]))a.push(n[u]),i=!0;else if(!i)a.push(n[u]);else break;n=n.slice(u);const c=a.join(`
`),d=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,o=o?`${o}
${d}`:d;const m=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,s,!0),this.lexer.state.top=m,n.length===0)break;const h=s.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const b=h,k=b.raw+`
`+n.join(`
`),L=this.blockquote(k);s[s.length-1]=L,r=r.substring(0,r.length-b.raw.length)+L.raw,o=o.substring(0,o.length-b.text.length)+L.text;break}else if((h==null?void 0:h.type)==="list"){const b=h,k=b.raw+`
`+n.join(`
`),L=this.list(k);s[s.length-1]=L,r=r.substring(0,r.length-h.raw.length)+L.raw,o=o.substring(0,o.length-b.raw.length)+L.raw,n=k.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:o}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,o={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const s=this.rules.other.listItemRegex(n);let i=!1;for(;e;){let u=!1,c="",d="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let m=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,Y=>" ".repeat(3*Y.length)),h=e.split(`
`,1)[0],b=!m.trim(),k=0;if(this.options.pedantic?(k=2,d=m.trimStart()):b?k=t[1].length+1:(k=t[2].search(this.rules.other.nonSpaceChar),k=k>4?1:k,d=m.slice(k),k+=t[1].length),b&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),u=!0),!u){const Y=this.rules.other.nextBulletRegex(k),A=this.rules.other.hrRegex(k),S=this.rules.other.fencesBeginRegex(k),P=this.rules.other.headingBeginRegex(k),re=this.rules.other.htmlBeginRegex(k);for(;e;){const X=e.split(`
`,1)[0];let Q;if(h=X,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),Q=h):Q=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||P.test(h)||re.test(h)||Y.test(h)||A.test(h))break;if(Q.search(this.rules.other.nonSpaceChar)>=k||!h.trim())d+=`
`+Q.slice(k);else{if(b||m.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(m)||P.test(m)||A.test(m))break;d+=`
`+h}!b&&!h.trim()&&(b=!0),c+=X+`
`,e=e.substring(X.length+1),m=Q.slice(k)}}o.loose||(i?o.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(i=!0));let L=null,J;this.options.gfm&&(L=this.rules.other.listIsTask.exec(d),L&&(J=L[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:c,task:!!L,checked:J,loose:!1,text:d,tokens:[]}),o.raw+=c}const a=o.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let u=0;u<o.items.length;u++)if(this.lexer.state.top=!1,o.items[u].tokens=this.lexer.blockTokens(o.items[u].text,[]),!o.loose){const c=o.items[u].tokens.filter(m=>m.type==="space"),d=c.length>0&&c.some(m=>this.rules.other.anyLine.test(m.raw));o.loose=d}if(o.loose)for(let u=0;u<o.items.length;u++)o.items[u].loose=!0;return o}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:o}}}table(e){var i;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=en(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=(i=t[3])!=null&&i.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const a of r)this.rules.other.tableAlignRight.test(a)?s.align.push("right"):this.rules.other.tableAlignCenter.test(a)?s.align.push("center"):this.rules.other.tableAlignLeft.test(a)?s.align.push("left"):s.align.push(null);for(let a=0;a<n.length;a++)s.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:s.align[a]});for(const a of o)s.rows.push(en(a,s.header.length).map((u,c)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:s.align[c]})));return s}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const s=ge(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{const s=Ja(t[2],"()");if(s===-2)return;if(s>-1){const a=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let r=t[2],o="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],o=s[3])}else o=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),tn(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=t[r.toLowerCase()];if(!o){const s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return tn(n,o,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const s=[...r[0]].length-1;let i,a,u=s,c=0;const d=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+s);(r=d.exec(t))!=null;){if(i=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!i)continue;if(a=[...i].length,r[3]||r[4]){u+=a;continue}else if((r[5]||r[6])&&s%3&&!((s+a)%3)){c+=a;continue}if(u-=a,u>0)continue;a=Math.min(a,a+u+c);const m=[...r[0]][0].length,h=e.slice(0,s+r.index+m+a);if(Math.min(s,a)%2){const k=h.slice(1,-1);return{type:"em",raw:h,text:k,tokens:this.lexer.inlineTokens(k)}}const b=h.slice(2,-2);return{type:"strong",raw:h,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),o=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&o&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,o;if(t[2]==="@")r=t[0],o="mailto:"+r;else{let s;do s=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(s!==t[0]);r=t[0],t[1]==="www."?o="http://"+t[0]:o=t[0]}return{type:"link",raw:t[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},H=class st{constructor(t){$(this,"tokens");$(this,"options");$(this,"state");$(this,"tokenizer");$(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||ue,this.options.tokenizer=this.options.tokenizer||new Ue,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:j,block:Re.normal,inline:me.normal};this.options.pedantic?(n.block=Re.pedantic,n.inline=me.pedantic):this.options.gfm&&(n.block=Re.gfm,this.options.breaks?n.inline=me.breaks:n.inline=me.gfm),this.tokenizer.rules=n}static get rules(){return{block:Re,inline:me}}static lex(t,n){return new st(n).lex(t)}static lexInline(t,n){return new st(n).inlineTokens(t)}lex(t){t=t.replace(j.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var o,s,i;for(this.options.pedantic&&(t=t.replace(j.tabCharGlobal,"    ").replace(j.spaceLine,""));t;){let a;if((s=(o=this.options.extensions)==null?void 0:o.block)!=null&&s.some(c=>(a=c.call({lexer:this},t,n))?(t=t.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(t)){t=t.substring(a.raw.length);const c=n.at(-1);a.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(t)){t=t.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(a=this.tokenizer.fences(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(t)){t=t.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(t)){t=t.substring(a.raw.length),n.push(a);continue}let u=t;if((i=this.options.extensions)!=null&&i.startBlock){let c=1/0;const d=t.slice(1);let m;this.options.extensions.startBlock.forEach(h=>{m=h.call({lexer:this},d),typeof m=="number"&&m>=0&&(c=Math.min(c,m))}),c<1/0&&c>=0&&(u=t.substring(0,c+1))}if(this.state.top&&(a=this.tokenizer.paragraph(u))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a),r=u.length!==t.length,t=t.substring(a.raw.length);continue}if(a=this.tokenizer.text(t)){t=t.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var a,u,c;let r=t,o=null;if(this.tokens.links){const d=Object.keys(this.tokens.links);if(d.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)d.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,o.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(o=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,i="";for(;t;){s||(i=""),s=!1;let d;if((u=(a=this.options.extensions)==null?void 0:a.inline)!=null&&u.some(h=>(d=h.call({lexer:this},t,n))?(t=t.substring(d.raw.length),n.push(d),!0):!1))continue;if(d=this.tokenizer.escape(t)){t=t.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.tag(t)){t=t.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.link(t)){t=t.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(d.raw.length);const h=n.at(-1);d.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=d.raw,h.text+=d.text):n.push(d);continue}if(d=this.tokenizer.emStrong(t,r,i)){t=t.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.codespan(t)){t=t.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.br(t)){t=t.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.del(t)){t=t.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.autolink(t)){t=t.substring(d.raw.length),n.push(d);continue}if(!this.state.inLink&&(d=this.tokenizer.url(t))){t=t.substring(d.raw.length),n.push(d);continue}let m=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const b=t.slice(1);let k;this.options.extensions.startInline.forEach(L=>{k=L.call({lexer:this},b),typeof k=="number"&&k>=0&&(h=Math.min(h,k))}),h<1/0&&h>=0&&(m=t.substring(0,h+1))}if(d=this.tokenizer.inlineText(m)){t=t.substring(d.raw.length),d.raw.slice(-1)!=="_"&&(i=d.raw.slice(-1)),s=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=d.raw,h.text+=d.text):n.push(d);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},Me=class{constructor(e){$(this,"options");$(this,"parser");this.options=e||ue}space(e){return""}code({text:e,lang:t,escaped:n}){var s;const r=(s=(t||"").match(j.notSpaceStart))==null?void 0:s[0],o=e.replace(j.endingNewline,"")+`
`;return r?'<pre><code class="language-'+q(r)+'">'+(n?o:q(o,!0))+`</code></pre>
`:"<pre><code>"+(n?o:q(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let i=0;i<e.items.length;i++){const a=e.items[i];r+=this.listitem(a)}const o=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+o+s+`>
`+r+"</"+o+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+q(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let o=0;o<e.header.length;o++)n+=this.tablecell(e.header[o]);t+=this.tablerow({text:n});let r="";for(let o=0;o<e.rows.length;o++){const s=e.rows[o];n="";for(let i=0;i<s.length;i++)n+=this.tablecell(s[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${q(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),o=Qt(e);if(o===null)return r;e=o;let s='<a href="'+e+'"';return t&&(s+=' title="'+q(t)+'"'),s+=">"+r+"</a>",s}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const o=Qt(e);if(o===null)return q(n);e=o;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${q(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:q(e.text)}},zt=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},V=class it{constructor(t){$(this,"options");$(this,"renderer");$(this,"textRenderer");this.options=t||ue,this.options.renderer=this.options.renderer||new Me,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new zt}static parse(t,n){return new it(n).parse(t)}static parseInline(t,n){return new it(n).parseInline(t)}parse(t,n=!0){var o,s;let r="";for(let i=0;i<t.length;i++){const a=t[i];if((s=(o=this.options.extensions)==null?void 0:o.renderers)!=null&&s[a.type]){const c=a,d=this.options.extensions.renderers[c.type].call({parser:this},c);if(d!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=d||"";continue}}const u=a;switch(u.type){case"space":{r+=this.renderer.space(u);continue}case"hr":{r+=this.renderer.hr(u);continue}case"heading":{r+=this.renderer.heading(u);continue}case"code":{r+=this.renderer.code(u);continue}case"table":{r+=this.renderer.table(u);continue}case"blockquote":{r+=this.renderer.blockquote(u);continue}case"list":{r+=this.renderer.list(u);continue}case"html":{r+=this.renderer.html(u);continue}case"paragraph":{r+=this.renderer.paragraph(u);continue}case"text":{let c=u,d=this.renderer.text(c);for(;i+1<t.length&&t[i+1].type==="text";)c=t[++i],d+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:d,text:d,tokens:[{type:"text",raw:d,text:d,escaped:!0}]}):r+=d;continue}default:{const c='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var o,s;let r="";for(let i=0;i<t.length;i++){const a=t[i];if((s=(o=this.options.extensions)==null?void 0:o.renderers)!=null&&s[a.type]){const c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=c||"";continue}}const u=a;switch(u.type){case"escape":{r+=n.text(u);break}case"html":{r+=n.html(u);break}case"link":{r+=n.link(u);break}case"image":{r+=n.image(u);break}case"strong":{r+=n.strong(u);break}case"em":{r+=n.em(u);break}case"codespan":{r+=n.codespan(u);break}case"br":{r+=n.br(u);break}case"del":{r+=n.del(u);break}case"text":{r+=n.text(u);break}default:{const c='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},Xe,Pe=(Xe=class{constructor(e){$(this,"options");$(this,"block");this.options=e||ue}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?H.lex:H.lexInline}provideParser(){return this.block?V.parse:V.parseInline}},$(Xe,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Xe),Yn=class{constructor(...e){$(this,"defaults",bt());$(this,"options",this.setOptions);$(this,"parse",this.parseMarkdown(!0));$(this,"parseInline",this.parseMarkdown(!1));$(this,"Parser",V);$(this,"Renderer",Me);$(this,"TextRenderer",zt);$(this,"Lexer",H);$(this,"Tokenizer",Ue);$(this,"Hooks",Pe);this.use(...e)}walkTokens(e,t){var r,o;let n=[];for(const s of e)switch(n=n.concat(t.call(this,s)),s.type){case"table":{const i=s;for(const a of i.header)n=n.concat(this.walkTokens(a.tokens,t));for(const a of i.rows)for(const u of a)n=n.concat(this.walkTokens(u.tokens,t));break}case"list":{const i=s;n=n.concat(this.walkTokens(i.items,t));break}default:{const i=s;(o=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&o[i.type]?this.defaults.extensions.childTokens[i.type].forEach(a=>{const u=i[a].flat(1/0);n=n.concat(this.walkTokens(u,t))}):i.tokens&&(n=n.concat(this.walkTokens(i.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){const s=t.renderers[o.name];s?t.renderers[o.name]=function(...i){let a=o.renderer.apply(this,i);return a===!1&&(a=s.apply(this,i)),a}:t.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=t[o.level];s?s.unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),r.extensions=t),n.renderer){const o=this.defaults.renderer||new Me(this.defaults);for(const s in n.renderer){if(!(s in o))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const i=s,a=n.renderer[i],u=o[i];o[i]=(...c)=>{let d=a.apply(o,c);return d===!1&&(d=u.apply(o,c)),d||""}}r.renderer=o}if(n.tokenizer){const o=this.defaults.tokenizer||new Ue(this.defaults);for(const s in n.tokenizer){if(!(s in o))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const i=s,a=n.tokenizer[i],u=o[i];o[i]=(...c)=>{let d=a.apply(o,c);return d===!1&&(d=u.apply(o,c)),d}}r.tokenizer=o}if(n.hooks){const o=this.defaults.hooks||new Pe;for(const s in n.hooks){if(!(s in o))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const i=s,a=n.hooks[i],u=o[i];Pe.passThroughHooks.has(s)?o[i]=c=>{if(this.defaults.async)return Promise.resolve(a.call(o,c)).then(m=>u.call(o,m));const d=a.call(o,c);return u.call(o,d)}:o[i]=(...c)=>{let d=a.apply(o,c);return d===!1&&(d=u.apply(o,c)),d}}r.hooks=o}if(n.walkTokens){const o=this.defaults.walkTokens,s=n.walkTokens;r.walkTokens=function(i){let a=[];return a.push(s.call(this,i)),o&&(a=a.concat(o.call(this,i))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return H.lex(e,t??this.defaults)}parser(e,t){return V.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const o={...r},s={...this.defaults,...o},i=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&o.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=e);const a=s.hooks?s.hooks.provideLexer():e?H.lex:H.lexInline,u=s.hooks?s.hooks.provideParser():e?V.parse:V.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(n):n).then(c=>a(c,s)).then(c=>s.hooks?s.hooks.processAllTokens(c):c).then(c=>s.walkTokens?Promise.all(this.walkTokens(c,s.walkTokens)).then(()=>c):c).then(c=>u(c,s)).then(c=>s.hooks?s.hooks.postprocess(c):c).catch(i);try{s.hooks&&(n=s.hooks.preprocess(n));let c=a(n,s);s.hooks&&(c=s.hooks.processAllTokens(c)),s.walkTokens&&this.walkTokens(c,s.walkTokens);let d=u(c,s);return s.hooks&&(d=s.hooks.postprocess(d)),d}catch(c){return i(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+q(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},ie=new Yn;function y(e,t){return ie.parse(e,t)}y.options=y.setOptions=function(e){return ie.setOptions(e),y.defaults=ie.defaults,jn(y.defaults),y};y.getDefaults=bt;y.defaults=ue;y.use=function(...e){return ie.use(...e),y.defaults=ie.defaults,jn(y.defaults),y};y.walkTokens=function(e,t){return ie.walkTokens(e,t)};y.parseInline=ie.parseInline;y.Parser=V;y.parser=V.parse;y.Renderer=Me;y.TextRenderer=zt;y.Lexer=H;y.lexer=H.lex;y.Tokenizer=Ue;y.Hooks=Pe;y.parse=y;y.options;y.setOptions;y.use;y.walkTokens;y.parseInline;V.parse;H.lex;const nn=new Yn({renderer:{html(e){return e.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/,"&quot;")}}}),$e=(e,t)=>(t!=null&&t.inline?nn.parseInline:nn.parse)(e,{breaks:!0}),z=l("div","#main-scene"),f={showGuestNav:l("span","#ms-show-guest-nav",z),backToMenuButton:l("button","#ms-button-reload",z),buttonProfile:l("button","#ms-button-profile",z),username:l("span","#ms-username",z),buttonInbox:l("button","#ms-button-inbox",z),buttonLiveChat:l("button","#ms-button-livechat",z),buttonGoToUser:l("button","#ms-button-go-to-user",z),buttonSettings:l("button","#ms-button-settings",z),buttonModeration:l("button","#ms-button-moderation",z),buttonLogOut:l("button","#ms-button-log-out",z),ulist:l("div","#ms-ulist",z),makePost:l("div","#ms-make-post",z),doNotTheSpamming:l("div","#ms-do-not-the-spamming",z),buttonPresets:l("button","#ms-button-presets",z),buttonAttachment:l("button","#ms-button-attachment",z),msg:l("textarea","#ms-msg",z),suggestions:l("div","#ms-suggestions",z),presets:l("span","#ms-presets",z),buttonPost:l("button","#ms-button-post",z),details:l("div","#ms-details",z),detailsText:l("span","#ms-details-text",z),detailsClear:l("button","#ms-details-clear",z),replies:l("div","#ms-replies",z),posts:l("div","#ms-posts",z),postTemplate:l("template","#ms-post-template",z),replyTemplate:l("template","#ms-reply-template",z),livechatPosts:l("div","#ml-posts",z)},G={};gt.then(e=>{f.username.textContent=e.username,f.showGuestNav.classList.add("hidden"),f.makePost.classList.remove("hidden"),f.buttonProfile.classList.remove("hidden"),f.buttonProfile.addEventListener("click",()=>{_e(e.username)}),f.buttonInbox.classList.remove("hidden"),f.buttonLiveChat.classList.remove("hidden"),f.buttonGoToUser.classList.remove("hidden"),f.buttonSettings.classList.remove("hidden"),e.permissions.length!==0&&f.buttonModeration.classList.remove("hidden"),f.buttonLogOut.classList.remove("hidden")});mt.then(e=>{e.messages.forEach(t=>{const n=tr(t,!1);G[t._id]={element:n,data:t,replies:[]},f.posts.append(n)}),er(e.ulist)});f.backToMenuButton.addEventListener("click",()=>{O("register-login")});f.buttonInbox.addEventListener("click",()=>{O("main-inbox")});f.buttonGoToUser.addEventListener("click",()=>{const e=prompt("What user do you want to go to?");e&&_e(e)});f.buttonModeration.addEventListener("click",()=>{O("main-moderation")});f.buttonSettings.addEventListener("click",()=>{O("main-config")});f.buttonLogOut.addEventListener("click",()=>{localStorage.removeItem("beardeer:token"),location.reload()});let le=!1;f.buttonLiveChat.addEventListener("click",()=>{le=!le,f.buttonLiveChat.textContent=le?"Home":"Livechat",f.posts.classList.toggle("hidden",le),f.livechatPosts.classList.toggle("hidden",!le)});f.msg.addEventListener("keydown",e=>{if(Zt(f.msg),ee("enterSends")&&e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),St()),e.key==="Tab"){const t=f.suggestions.firstChild;t&&t instanceof HTMLButtonElement&&(t.click(),e.preventDefault())}});["touchstart","keyup","mouseup","keydown","focus"].forEach(e=>{f.msg.addEventListener(e,()=>Qn())});f.buttonPost.addEventListener("click",()=>{St()});let K=[],se=[];const St=async()=>{await D({command:"post",content:f.msg.value,...le?{chat:"livechat"}:{},replies:K,attachments:se},w({}))&&(K=[],f.msg.value="",Zt(f.msg),Xn())},Zt=e=>{requestAnimationFrame(()=>{e.style.minHeight="auto",e.style.minHeight=e.scrollHeight+"px"})},Et=()=>{K.length===0&&se.length===0?f.details.classList.add("hidden"):(f.details.classList.remove("hidden"),f.detailsText.textContent=`${K.length} repl${K.length===1?"y":"ies"}, ${se.length} attachment${se.length===1?"":"s"}`)};f.buttonAttachment.addEventListener("click",()=>{if(se.length===5){alert("You already have 5 attachments.");return}const e=prompt("Attachment URL...");e&&(se.push(e),Et())});f.detailsClear.addEventListener("click",()=>Xn());const Xn=()=>{K=[],se=[],f.replies.innerHTML="",Et()};let be=!1;f.buttonPresets.addEventListener("click",()=>{be=!be,f.doNotTheSpamming.classList.toggle("hidden",!be),f.msg.classList.toggle("hidden",be),f.presets.classList.toggle("hidden",!be)});f.presets.querySelectorAll("button").forEach(e=>{e.addEventListener("click",()=>{f.msg.value=e.textContent||"",St()})});function Qn(){const e=Xa();f.suggestions.innerHTML="",e!==null&&f.suggestions.append(...e.map(({desc:t,string:n,newPos:r})=>{const o=document.createElement("button");return o.textContent=t,o.addEventListener("click",()=>{f.msg.value=n,f.msg.setSelectionRange(r,r),f.msg.focus(),Qn()}),o}))}function Xa(){if(f.suggestions.classList.remove("hidden"),f.msg.selectionStart!==f.msg.selectionEnd)return null;const e=ec();if(e!==null)return e;const t=f.msg.value.slice(0,f.msg.selectionStart),n=f.msg.value.slice(f.msg.selectionStart),r=t.match(/@([a-zA-Z\-_0-9]*)$/);if(r){const o=r[1];return we.filter(i=>i!==o&&i.startsWith(o)).map(i=>({desc:"@"+i,string:t.slice(0,-r[0].length)+"@"+i+(n.startsWith(" ")?"":" ")+n,newPos:f.msg.selectionStart+1+(i.length-o.length)}))}return null}const Qa=[{showIf:()=>we.includes("bot"),prefix:"/",commands:["help","ping","whoami","dice","expose ","grrr","me","orange","work","fish","about","golf","glungus","thesoupiscoldandthesaladishot","count ","math ","lb","pi","bal","8ball","glup","notify ","reversefish","hEmulator ","shameposts"]},{showIf:()=>we.includes("legoshi"),prefix:"@legoshi ",commands:["help","quote","cat","death","math ","kill ","balance","labor","reverselabor","shop","buy "]},{showIf:()=>we.includes("sb4bot"),prefix:"@sb4bot ",commands:["help","balance","notify ","reversework","rps ","rng ","wawameter ","work"]}];function ec(){if(f.msg.selectionStart!==f.msg.value.length)return null;const e=Qa.find(t=>f.msg.value.startsWith(t.prefix)&&t.showIf());return e?e.commands.map(t=>e.prefix+t).filter(t=>t!==f.msg.value&&t.startsWith(f.msg.value)).map(t=>({desc:t.trim(),string:t,newPos:t.length})):null}Ge(w({command:W("ulist"),ulist:Nn}),e=>{er(e.ulist)});Ge(w({command:W("new_post"),data:An,origin:W("livechat").optional()}),e=>{const t=tr(e.data,!!e.origin);G[e.data._id]={element:t,data:e.data,replies:[]},(e.origin?f.livechatPosts:f.posts).insertAdjacentElement("afterbegin",t)});Ge(w({command:W("edited_post"),_id:v(),content:v()}),e=>{const t=G[e._id];if(!t){console.warn(`No post with the ID ${e._id} found`);return}t.data.content=e.content,t.element&&(l("div",".post-content",t.element).innerHTML=$e(e.content)),t.replies.forEach(n=>{l("span",".reply-content",n).innerHTML=$e(e.content,{inline:!0})})});Ge(w({command:W("deleted_post"),_id:v(),deleted_by_author:ht()}),e=>{const t=G[e._id];if(!t){console.warn(`No post with the ID ${e._id} found`);return}const n=e.deleted_by_author?"post deleted by author":"post deleted by moderator",r=t.element;if(r){const o=document.createElement("div");o.classList.add("post-deletion-message"),o.textContent=n,r.replaceWith(o)}t.replies.forEach(o=>{l("span",".reply-display-name",o).textContent="deleted",l("span",".reply-username",o).textContent="deleted",l("span",".reply-content",o).textContent=n}),delete G[e._id]});const tc=e=>e===null?" 🤖":e.startsWith("BossDeer ")?" 🦌":e.startsWith("BearDeer")?" 🐻":e.startsWith("BetterDeer ")?" ✨":e.startsWith("PresetDeer ")?" 🧩":e.startsWith("Kansas")?" 🇺🇸":e.startsWith("whitetail")?"🦨":e==="Unknown"?"❓":"🤖";let we=[];const er=e=>{const t=Object.entries(e);if(we=t.map(([n])=>n),t.length===0){f.ulist.innerHTML="Nobody is online. 😥🦌";return}if(t.length===1){f.ulist.innerHTML="You are the only user online. 😥🦌";return}f.ulist.textContent=`${t.length} users online (`,t.forEach(([n,{client:r}],o)=>{const s=document.createElement("button");s.classList.add("no-button-styles"),s.textContent=n+" "+tc(r),s.addEventListener("click",()=>{_e(n)}),s.title=r||"",f.ulist.append(s),o!==t.length-1&&f.ulist.append(", ")}),f.ulist.append(")")},tr=(e,t)=>{const n=l("div",".post",an(f.postTemplate));l("img",".pfp",n).src=e.author.avatar,l("button",".post-pfp",n).addEventListener("click",()=>{_e(e.author.username)}),l("b",".post-display-name",n).textContent=e.author.display_name,l("span",".post-username",n).textContent=e.author.username,l("button",".post-author",n).addEventListener("click",()=>{_e(e.author.username)}),l("span",".post-date",n).textContent=e.created.toLocaleString();const r=l("div",".post-content",n);r.innerHTML=$e(e.content);const o=l("div",".post-replies",n);e.replies.forEach(c=>{const d=rn(c);G[c._id]?G[c._id].replies.push(d):G[c._id]={data:c,replies:[d]},o.append(d)});const s=l("div",".post-attachments",n);e.attachments.forEach(c=>{const d=document.createElement("div");d.classList.add("attachment"),s.append(d),fetch(c,{method:"HEAD"}).then(async m=>{var h;if((h=m.headers.get("content-type"))!=null&&h.startsWith("video/")){const b=document.createElement("video");b.src=c,b.addEventListener("loadeddata",()=>{b.height=b.clientHeight,b.width=b.clientWidth}),b.controls=!0,d.append(b)}else{const b=document.createElement("img");b.src=c,d.append(b)}}).catch(()=>{const m=document.createElement("img");m.src=c,d.append(m)})}),l("button",".post-reply-button",n).addEventListener("click",()=>{K.length===5||K.some(c=>c===e._id)||(K.push(e._id),f.replies.append(rn(e)),Et(),f.msg.focus())}),gt.then(c=>{t||(l("span",".post-reply-button-area",n).classList.remove("hidden"),c.username===e.author.username&&l("span",".post-edit-button-area",n).classList.remove("hidden"),(c.username===e.author.username||c.permissions.includes("DELETE"))&&l("span",".post-delete-button-area",n).classList.remove("hidden"))});const i=l("div",".post-content-editing",n),a=l("textarea",".post-content-editing-textarea",n),u=async()=>{await D({command:"edit_post",id:e._id,content:a.value},w({}))&&(r.classList.remove("hidden"),i.classList.add("hidden"))};return a.addEventListener("keydown",c=>{Zt(a),ee("enterSends")&&c.key==="Enter"&&!c.shiftKey&&(u(),c.preventDefault())}),l("button",".post-edit-button",n).addEventListener("click",()=>{r.classList.add("hidden"),i.classList.remove("hidden"),a.value=G[e._id].data.content,a.focus()}),l("button",".post-content-editing-ok",n).addEventListener("click",u),l("button",".post-content-editing-cancel",n).addEventListener("click",()=>{r.classList.remove("hidden"),i.classList.add("hidden")}),l("button",".post-delete-button",n).addEventListener("click",()=>{confirm(`Do you want to delete this post?
${e.content}`)&&D({command:"delete_post",id:e._id},w({}))}),n},rn=e=>{const t=l("button",".reply",an(f.replyTemplate));l("span",".reply-display-name",t).textContent=typeof e.author=="string"?e.author:e.author.display_name,l("span",".reply-username",t).textContent=typeof e.author=="string"?e.author:e.author.username;const n=l("span",".reply-content",t);return n.innerHTML=$e(e.content,{inline:!0}),t.addEventListener("click",()=>{var r,o;(o=(r=G[e._id])==null?void 0:r.element)==null||o.scrollIntoView({behavior:"smooth"})}),t},F=l("div","#register-login"),U={tabLogin:l("button","#rl-t-login",F),tabSignup:l("button","#rl-t-signup",F),tabGuest:l("button","#rl-t-guest",F),loginContainer:l("div","#rl-login-container",F),signupContainer:l("div","#rl-signup-container",F),loginUsername:l("input","#rl-username",F),loginPassword:l("input","#rl-password",F),loginButton:l("button","#rl-login-button",F),signupUsername:l("input","#rl-username-s",F),signupPassword:l("input","#rl-password-s",F),signupInviteCode:l("input","#rl-invitecode",F),signupButton:l("button","#rl-signup-button",F)};U.tabLogin.addEventListener("click",()=>{U.loginContainer.classList.remove("hidden"),U.signupContainer.classList.add("hidden")});U.tabSignup.addEventListener("click",()=>{U.loginContainer.classList.add("hidden"),U.signupContainer.classList.remove("hidden")});U.tabGuest.addEventListener("click",()=>{O("main-scene")});U.loginButton.addEventListener("click",async()=>{const e=await D({command:"login_pswd",username:U.loginUsername.value,password:U.loginPassword.value,client:"BearDeer v2"},w({token:v(),user:ce}));e&&(Bn(e.token,e.user),O("main-scene"))});U.signupButton.addEventListener("click",async()=>{const e=await D({command:"register",username:U.signupUsername.value,password:U.signupPassword.value,invite_code:U.signupInviteCode.value,client:"BearDeer v2"},w({token:v(),user:ce}));e&&(localStorage.setItem("beardeer:token",e.token),location.reload())});const Ce=localStorage.getItem("beardeer:token");cn("register-login",()=>{Ce&&O("main-scene")});mt.then(async()=>{if(Ce){const e=await D({command:"login_token",token:Ce,client:"BearDeer v2"},w({user:ce}));if(!e){O("register-login");return}Bn(Ce,e.user)}});const on=l("div","#user-display"),Ae={buttonBack:l("button","#ud-button-back",on),iframe:l("iframe","#ud-iframe",on)};Ae.buttonBack.addEventListener("click",()=>{O("main-scene")});const sn={cole:"America/Detroit",delusions:"Europe/London",engineerrunner:"Europe/London",mybearworld:"Europe/Berlin",noodles:"-05:00",notfenixio:"Europe/Madrid",pix:"America/Detroit",pkmnq:"+08:00",stripes:"America/Detroit",wlodekm:"Europe/Kyiv"};let Ye=null;at("user-display",async()=>{Ae.iframe.classList.add("hidden");const e=await D({command:"get_user",username:sr()},w({user:ce}));if(!e){O("main-scene");return}const t=Ae.iframe.contentDocument;if(!t)throw new Error("No document");l("style","#ud-custom-css",t).innerHTML=e.user.profile.css||"",l("style","#ud-theme",t).innerHTML=We[ee("theme")],l("span","#ud-d-tags",t).innerHTML="",l("img","#ud-avatar",t).src=e.user.avatar,l("span","#ud-display-name",t).innerText=e.user.display_name,l("span","#ud-username",t).innerText="@"+e.user.username;const n=l("div","#ud-banner",t);if(n.style.backgroundImage=e.user.banner?`url('${e.user.banner}')`:"",n.classList.toggle("has-banner",!!e.user.banner),e.user.username in sn){const o=new Intl.DateTimeFormat([],{timeZone:sn[e.user.username],dateStyle:"short",timeStyle:"medium"}),s=()=>{l("span","#ud-tz",t).innerText=o.format(new Date)};Ye!==null&&clearInterval(Ye),s(),Ye=setInterval(s,500)}else l("span","#ud-tz",t).innerText="Unknown";if(l("span","#ud-created",t).innerText=e.user.created.toLocaleString(),l("small","#ud-permissions",t).innerText=`Permissions: ${e.user.permissions.toString().toLowerCase().replace(/,/g,", ")}`,l("small","#ud-special",t).innerHTML="",e.user.banned_until>new Date().getTime()/1e3?(l("span","#ud-banned-span",t).innerText=`Banned until ${new Date(e.user.banned_until*1e3).toLocaleString()}`,l("span","#ud-banned",t).classList.remove("hidden")):l("span","#ud-banned",t).classList.add("hidden"),l("span","#ud-bio",t).innerHTML=$e(e.user.profile.bio)||"This user does not have a bio.",e.user.profile.lastfm){l("div","#ud-lastfm-container",t).classList.add("hidden");var r=new XMLHttpRequest;r.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var o=JSON.parse(r.responseText);o.track["@attr"]&&o.track["@attr"].nowplaying?(l("div","#ud-lastfm-container",t).classList.remove("hidden"),l("img","#ud-lastfm-cover",t).src=o.track.image[o.track.image.length-1]["#text"],l("span","#ud-lastfm-name",t).innerText=o.track.name,l("span","#ud-lastfm-album",t).innerText=`on "${o.track.album["#text"]}"`,l("span","#ud-lastfm-artist",t).innerText=`by "${o.track.artist["#text"]}"`):l("div","#ud-lastfm-container",t).classList.add("hidden")}},r.open("GET",`https://lastfm.kije.workers.dev/${e.user.profile.lastfm}`,!0),r.send()}else l("div","#ud-lastfm-container",t).classList.add("hidden");Ae.iframe.classList.remove("hidden")});O("register-login");
